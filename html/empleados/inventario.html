<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Inventario - Sistema de Cafetería</title>
    <link rel="stylesheet" href="../../css/styles.css">
</head>
<body>
    <div class="dashboard-container">
        <nav class="sidebar">
            <div class="logo">
                <h2>Sistema de Cafetería</h2>
            </div>
            <ul class="nav-menu">
                <li><a href="productos.html" class="nav-item">Productos</a></li>
                <li><a href="inventario.html" class="nav-item active">Inventario</a></li>
                <li><a href="proveedores.html" class="nav-item">Proveedores</a></li>
                <li><a href="ventas.html" class="nav-item">Ventas</a></li>
            </ul>
            <div class="user-info">
                <span class="user-name">Usuario: Empleado</span>
                <a href="../auth/login.html" class="logout-button">Cerrar Sesión</a>
            </div>
        </nav>
        
        <main class="main-content">
            <header class="dashboard-header">
                <h1>Gestión de Inventario</h1>
                <button class="add-button" onclick="mostrarFormulario()">Agregar Producto al Inventario</button>
            </header>
            
            <div class="search-filters">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Buscar producto...">
                    <button class="search-button" onclick="filtrarInventario()">
                        <i class="fas fa-search"></i> Buscar
                    </button>
                </div>
                
                <div class="filters-container">
                    <div class="filter-group">
                        <label for="filterCategory">Categoría</label>
                        <select id="filterCategory">
                            <option value="">Todas las categorías</option>
                            <option value="cafe">Café</option>
                            <option value="postres">Postres</option>
                            <option value="bebidas">Bebidas</option>
                            <option value="insumos">Insumos</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterStock">Estado de Stock</label>
                        <select id="filterStock">
                            <option value="">Todos</option>
                            <option value="bajo">Stock Bajo</option>
                            <option value="normal">Stock Normal</option>
                            <option value="alto">Stock Alto</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterDiscount">Descuentos</label>
                        <select id="filterDiscount">
                            <option value="">Todos</option>
                            <option value="con-descuento">Con Descuento</option>
                            <option value="sin-descuento">Sin Descuento</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="inventory-table-container">
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Producto</th>
                            <th>Categoría</th>
                            <th>Stock Actual</th>
                            <th>Stock Mínimo</th>
                            <th>Precio Base</th>
                            <th>Descuento</th>
                            <th>Precio Final</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Café Americano</td>
                            <td>Café</td>
                            <td>50</td>
                            <td>20</td>
                            <td>$2.50</td>
                            <td>
                                <div class="discount-badge">15%</div>
                            </td>
                            <td>$2.13</td>
                            <td><span class="status normal">Normal</span></td>
                            <td>
                                <button class="action-button edit">Editar</button>
                                <button class="action-button delete">Eliminar</button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Croissant</td>
                            <td>Postres</td>
                            <td>15</td>
                            <td>25</td>
                            <td>$1.80</td>
                            <td>
                                <div class="discount-badge">0%</div>
                            </td>
                            <td>$1.80</td>
                            <td><span class="status bajo">Bajo</span></td>
                            <td>
                                <button class="action-button edit">Editar</button>
                                <button class="action-button delete">Eliminar</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Modal para agregar/editar producto en inventario -->
            <div id="inventoryModal" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>Gestionar Producto en Inventario</h2>
                    <form id="inventoryForm">
                        <div class="form-group">
                            <label for="producto">Producto</label>
                            <select id="producto" name="producto" required>
                                <option value="">Seleccionar producto...</option>
                                <option value="1">Café Americano</option>
                                <option value="2">Croissant</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="stockActual">Stock Actual</label>
                            <input type="number" id="stockActual" name="stockActual" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="stockMinimo">Stock Mínimo</label>
                            <input type="number" id="stockMinimo" name="stockMinimo" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="precioBase">Precio Base</label>
                            <input type="number" id="precioBase" name="precioBase" min="0" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="descuento">Descuento (%)</label>
                            <input type="number" id="descuento" name="descuento" min="0" max="100" value="0">
                            <div class="discount-preview">
                                <span>Precio Final: $</span>
                                <span id="precioFinal">0.00</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="notas">Notas</label>
                            <textarea id="notas" name="notas" rows="3"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="submit-button">Guardar</button>
                            <button type="button" class="cancel-button" onclick="cerrarModal()">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>
    <script>
        // Funciones para el modal
        function mostrarFormulario() {
            document.getElementById('inventoryModal').style.display = 'block';
        }

        function cerrarModal() {
            document.getElementById('inventoryModal').style.display = 'none';
        }

        // Cerrar modal al hacer clic en el botón de cerrar
        document.querySelector('.close-button').onclick = cerrarModal;

        // Cerrar modal al hacer clic fuera del contenido
        window.onclick = function(event) {
            if (event.target == document.getElementById('inventoryModal')) {
                cerrarModal();
            }
        }

        // Calcular precio final con descuento
        function calcularPrecioFinal() {
            const precioBase = parseFloat(document.getElementById('precioBase').value) || 0;
            const descuento = parseFloat(document.getElementById('descuento').value) || 0;
            const precioFinal = precioBase * (1 - descuento / 100);
            document.getElementById('precioFinal').textContent = precioFinal.toFixed(2);
        }

        // Actualizar precio final cuando cambie el precio base o el descuento
        document.getElementById('precioBase').addEventListener('input', calcularPrecioFinal);
        document.getElementById('descuento').addEventListener('input', calcularPrecioFinal);

        // Manejo del formulario
        document.getElementById('inventoryForm').onsubmit = function(e) {
            e.preventDefault();
            // Aquí iría la lógica para guardar el producto en inventario
            cerrarModal();
        }

        // Búsqueda y filtrado
        function filtrarInventario() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const filterCategory = document.getElementById('filterCategory').value;
            const filterStock = document.getElementById('filterStock').value;
            const filterDiscount = document.getElementById('filterDiscount').value;
            const rows = document.querySelectorAll('.inventory-table tbody tr');

            rows.forEach(row => {
                const producto = row.cells[1].textContent.toLowerCase();
                const categoria = row.cells[2].textContent.toLowerCase();
                const stockActual = parseInt(row.cells[3].textContent);
                const stockMinimo = parseInt(row.cells[4].textContent);
                const descuento = row.cells[6].textContent.trim();
                
                const matchesSearch = producto.includes(searchText);
                const matchesCategory = !filterCategory || categoria.includes(filterCategory.toLowerCase());
                
                let matchesStock = true;
                if (filterStock) {
                    if (filterStock === 'bajo') matchesStock = stockActual < stockMinimo;
                    else if (filterStock === 'normal') matchesStock = stockActual >= stockMinimo && stockActual <= stockMinimo * 2;
                    else if (filterStock === 'alto') matchesStock = stockActual > stockMinimo * 2;
                }
                
                const matchesDiscount = !filterDiscount || 
                    (filterDiscount === 'con-descuento' && descuento !== '0%') ||
                    (filterDiscount === 'sin-descuento' && descuento === '0%');

                row.style.display = matchesSearch && matchesCategory && matchesStock && matchesDiscount ? '' : 'none';
            });
        }

        // Aplicar filtros cuando cambien los selectores
        document.getElementById('filterCategory').onchange = filtrarInventario;
        document.getElementById('filterStock').onchange = filtrarInventario;
        document.getElementById('filterDiscount').onchange = filtrarInventario;

        // Manejo de botones de acción
        document.querySelectorAll('.action-button.edit').forEach(button => {
            button.onclick = function() {
                const row = this.closest('tr');
                // Aquí iría la lógica para cargar los datos del producto en el formulario
                mostrarFormulario();
            }
        });

        document.querySelectorAll('.action-button.delete').forEach(button => {
            button.onclick = function() {
                if (confirm('¿Está seguro de que desea eliminar este producto del inventario?')) {
                    // Aquí iría la lógica para eliminar el producto del inventario
                    this.closest('tr').remove();
                }
            }
        });
    </script>
</body>
</html> 